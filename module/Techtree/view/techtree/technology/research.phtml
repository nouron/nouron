<!-- Modal -->
<div id="techModal" class="modal hide fade in research" aria-hidden="false" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" style="display: block;">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h3 id="myModalLabel"><?= $this->translate($research['name']) ?> (<?= $research['level'] ?>)
            <small>(<?= $this->translate('types_' . 'research') ?>/<?= $this->translate('purposes_' . $research['purpose']) ?>)</small>
        </h3>
    </div>
    <div class="modal-body">
        <!-- Description -->
        <p><?= $this->translate('desc_'.$research['name'])?></p>
        freie AP: <?= $ap_available ?>
        <!-- Data -->

        <!-- Costs -->
        <h4><?= $this->translate('costs and requirements') ?></h4>

        <table class="table">

        <tr>
        <td><i class="<?= ($required_resources_check==true)? 'icon-ok' : 'icon-remove' ?>"></i></td>
        <td>
        <?php
        foreach ($costs as $cost):
            $resource = $resources[ $cost->getResourceId() ];
            $name = $resource['name'];
            $abbreviation =  $resource['abbreviation'];
            $class  = $resource['icon'];
            $amount = $cost->getAmount();
            if ($amount > 0):
                echo '<a data-placement="bottom" rel="tooltip" href="#" data-original-title="'.$name.'">';
                echo '<i class="'.$class.'">'.$abbreviation.'</i> '.$amount.'</a> ';
            endif;
        endforeach;
        ?>
        </td>
        </tr>
        <?php if (!empty($research['required_building_id'])): ?>
        <tr>
            <td><?= $required_buildings_check ? '<i class="icon-ok"></i>' : '<i class="icon-remove"></i>'; ?></td>
            <td><?= $this->translate( $buildings[ $research['required_building_id'] ]['name'] ) ?> (<?= $research['required_building_level'] ?>)</td>
        </tr>
        <?php endif; ?>
        <tr>
           <td colspan="2">
           <?php $poss = array_key_exists($research['id'], $possessions ) ? $possessions[$research['id']] : null; ?>
           <?= $this->partial('partial/techstatus_bar', array('tech'=>$research, 'type'=>'research', 'poss'=>$poss, 'ap_spend'=> $research['ap_spend'], 'ap_available'=> $ap_available)) ?>
           <? $class = ($research['status_points'] == 0 && $research['level'] > 0) ? 'btn-danger': 'disabled';?>
           <a id="research-<?= $research['id'] ?>|leveldown"  class="btn <?= $class ?>" >abreißen</a>
           </td>
        </tr>
        <tr>
            <td colspan="2">
            <?= $this->partial('partial/techlevelup_bar', array('tech'=>$research, 'type'=>'research', 'ap_spend'=> $research['ap_spend'], 'ap_available'=> $ap_available)) ?>
            <? $class = ($research['ap_spend'] >= $research['ap_for_levelup']) ? 'btn-success': 'disabled';?>
            <? if (($required_buildings_check && $required_resources_check) == false): ?>
            <a id="research-<?= $research['id'] ?>|levelup" class="btn disabled" >ausbauen</a>
            <? else: ?>
            <a id="research-<?= $research['id'] ?>|levelup" class="btn <?= $class ?>" >ausbauen</a>
            <? endif; ?>
            </td>
        </tr>
        </table>
        <?php if (is_array($message)): ?>
        <div class="alert alert-<?= $message[0] ?>">
            <p><i class="icon icon-error"></i><?= $message[1] ?></p>
        </div>
        <?php endif;?>
    </div>
</div>