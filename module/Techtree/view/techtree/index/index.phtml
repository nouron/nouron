<?= $this->partial('partial/_switch_tech_display') ?>
<hr />
<div class="row-fluid"  id="colony">
  <div id="visualTechtree" class="row-fluid" style="position:relative">
      <div id="storage-tech-id" class="hidden"></div>
      <div id="storage" class="hidden"></div>
    <svg class="grid-svg" id="grid-svg" height="100%" width="100%" >
        <rect x="0" y="0" height="10" width="10" stroke="black" />
        <rect x="100" y="100" height="10" width="10" stroke="black" />
        <!-- svg content via javascript -->
    </svg>

    <div class="grid">
    <?php for ($row=0; $row<=15; $row++): ?>
      <div class="row-fluid">
          <?php for ($col=0; $col<=5; $col++): ?>
          <span class="span2 grid-cell" id="<?= "grid-$row-$col"?>"></span>
          <?php endfor; ?>
      </div>
    <?php endfor; ?>
    </div>

    <div class="hidden">
        <?php
        foreach ($techtree['buildings'] as $id => $tech) :
            echo $this->partial("partial/_techdata", array('tech'=>$tech, 'type' => 'building'));
            if ($tech['required_building_id'] != null) {
                echo $this->partial("partial/_techrequirement", array(
                    'fromTech'=>$techtree['buildings'][$tech['required_building_id']],
                    'toTech'=>$techtree['buildings'][$id],
                    'required_tech_count'=>$tech['required_building_level'],
                    'type' => 'building'
                ));
            }
        endforeach;
        foreach ($techtree['researches'] as $id => $tech) :
            echo $this->partial("partial/_techdata", array('tech'=>$tech, 'type' => 'research'));
            if ($tech['required_building_id'] != null) {
                echo $this->partial("partial/_techrequirement", array(
                    'fromTech'=>$techtree['buildings'][$tech['required_building_id']],
                    'toTech'=>$techtree['researches'][$id],
                    'required_tech_count'=>$tech['required_building_level'],
                    'type' => 'research'
                ));
            }
        endforeach;
        foreach ($techtree['ships'] as $id => $tech) :
            echo $this->partial("partial/_techdata", array('tech'=>$tech, 'type' => 'ship'));
            if ($tech['required_research_id'] != null) {
                echo $this->partial("partial/_techrequirement", array(
                    'fromTech'=>$techtree['researches'][$tech['required_research_id']],
                    'toTech'=>$techtree['ship'][$id],
                    'required_tech_count'=>$tech['required_research_level'],
                    'type' => 'ship'
                ));
            }
        endforeach;
        foreach ($techtree['personell'] as $id => $tech) :
            echo $this->partial("partial/_techdata", array('tech'=>$tech, 'type' => 'personell'));
            if ($tech['required_building_id'] != null) {
                echo $this->partial("partial/_techrequirement", array(
                    'fromTech'=>$techtree['buildings'][$tech['required_building_id']],
                    'toTech'=>$techtree['personell'][$id],
                    'required_tech_count'=>$tech['required_building_level'],
                    'type' => 'personell'
                ));
            }
        endforeach;
        ?>
  </div>

  <!-- Modal -->
  <!-- this Modal is filled with html data from json request -->
  <div id="techModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
          <h3 id="myModalLabel">Loading...</h3>
      </div>
      <div class="modal-body">
          <p>Loading...</p>
          <hr />
      </div>
      <div class="modal-footer">

      </div>
    </div>
</div>